```{r G1_5_paketit, include=FALSE}
# Paketit 1.2.20, kommentoin pois ne joita ei ole käytetty (likert, stargazer)
library(rgl)
library(ca)
library(haven)
library(dplyr)
library(knitr)
library(tidyverse)
library(lubridate)
library(rmarkdown)
library(ggplot2)
library(furniture)
# library(likert) # ei käytetty(1.2.20)
library(scales) # G_1_2 - kuva
library(reshape2)  # G_1_2 - kuva
library(printr) #19.5.18 taulukoiden ja matriisien tulostukseen
# library(stargazer) # 28.5.2018 taulukoiden yms. tulostukseen,ei käytetty(1.2.20)

#Uusia 13.6.2018
library(bookdown)
library(tinytex)
# Uusia 1/2020
library(assertthat)
library(testthat)
#
#r-skripteillä riittää, kun ajaa tämän
# sessionInfo()
```

# Yksinkertaisen korrespondenssianalyysin laajennuksia 2

**TODO** Vielä kuuden maan aineistolla ilman puuttuvia havaintoja? Helpompi 
havainnollistaa taulukoiden pinoamista / liittämistä (concate, stack). Ja voisi 
jatkaa ehkä pari pointtia pienellä aineistolla?

```{r G1_5_isodata}

#str(ISSP2012jh1d.dat)
# Yksinkertaisuuden vuoksi muuttujat tähän

#isodataVars1 <- ISSP2012jh1d.dat %>% names()
#isodataVars1 <- isodataVars1[24:73]
#demogrVars1 <- c("maa","maa3","sp","ika")
#isodataVars1 <- isodataVars1[21:50]
#isodataVars1 <- c(demogrVars1, isodataVars1)
#isodataVars1

ISSP2012jh1d.dat %>% select(all_of(isodataVars1)) %>% summary()

```

Data on valmiina, edellisen luvun ikäluokka, ikä-sukupuoli- muuttuja ja 
ikä-sukupuoli- maa muuttujien luontia voi harkita.

**edit** Tässä keskityttävä data-analyysin **tutkimusongelmiin**, johdantoa MCA-lukuun.

## Päällekkäiset matriisit (stacked matices)

Ref:CAip, CA_Week2.pdf (kalvot MCA-kurssilta 2017)


Concatenated tables (yhdistetyt taulut tai matriisit): (a) kaksi luokittelumuuttujaa (b) useita muuttujia stacked ("pinotaan").

MCA 2017 laskareissa ja kalvoissa esitetään, miten nämä saadaan kätevästi CA-paketin MJCA-funktion BURT-optiolla.



## Matched matrices

Ref:CAip ss. 177, HY2017_MCA, Greenacre JAS 2013 (sovellus ISSP 1989, 4 kysymystä 'pitäisikö äidin olla kotona', 8 maata), tässä artikkelissa "SVD-based methods", joista yksi CA (muut biplots, PCA, compositional data/log ratios).

Edellisen menetelmän variantti, jossa ryhmien väliset ja sisäiset erot saadaan esiin. Inertian jakaminen.
Samanlaisten rivien ja sarakkeiden kaksi samankokoista taulua, esimerkiksi sukupuolivaikutusten arviointi. Alkuperäinen taulukko jaetaan kahdeksi tauluksi sukupuolen mukaan. Matriisien yhdistäminen (concatenation) riveittäin tai sarakkeittain ei näytä optimaalisesti mm - matriisien eroja.

Ryhmien välisen ja ryhmien sisäinen inertian erottaminen, **ABBA** on yksi ratkaisu (ABBA matrix, teknisesti block circulanMat matrix).

Luokittelu voi olla myös kahden indikaattorimuuttujan avulla jako neljään taulukkoon (esim. miehet vs. naiset länsieuroopassa verratuna samaan asetelmaan itä-Euroopassa). Samaa ideaa laajennetaan.

Esimerkkinä "Attitudes to women working in 2012".



