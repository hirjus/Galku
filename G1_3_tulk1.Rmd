
# Tulkinnan perusteita

```{r paketit-g13, include=FALSE}
# Paketit 1.2.20, kommentoin pois ne joita ei ole käytetty (likert, stargazer)
library(rgl)
library(ca)
library(haven)
library(dplyr)
library(knitr)
library(tidyverse)
library(lubridate)
library(rmarkdown)
library(ggplot2)
library(furniture)
# library(likert) # ei käytetty(1.2.20)
library(scales) # G_1_2 - kuva
library(reshape2)  # G_1_2 - kuva
library(printr) #19.5.18 taulukoiden ja matriisien tulostukseen
# library(stargazer) # 28.5.2018 taulukoiden yms. tulostukseen,ei käytetty(1.2.20)

#Uusia 13.6.2018
library(bookdown)
library(tinytex)
# Uusia 1/2020
library(assertthat)
library(testthat)
#

sessionInfo()

```
Luvussa syvennetään esimerkin tulkinnan perusteita. Miksi symmetrinen kartta on yleensä paras vaihtoehto, siksi se oletusarvoisesti esitetäänkin. Milloin voi käyttää vaihtoehtoisia esitystapoja? **Ydinluku**.

Esimerkkiaineistossa tulee jo pohdittavaa, Guttman (arc, horseshoe) - efekti, ratkaisun dimensiot jne.

Asymmetrinen kartta, jossa riviprofiilit ovat pääkomponentti-koordinaateissa ja sarakeprofiilit standardikoordinaateissa.

(@) Sarakkeet ideaalipisteinä, edustavat kuvittellisia maita joissa kaikki ovat vastanneet vain yhdellä tavalla.

(@) Sarakepisteet kaukana origosta, koska skaalattu

(@) Rivipisteet kasautuneet keskiarvopisteen ympärille

(@) Rivi-ja sarakepisteiden suhteelliset sijannit samat kuin symmetrisessä kuvassa

(@) Tässäkin kuvassa pisteen koko kuvaa sen massaa. Sarakkeista "täysin samaa mieltä" (ts) ja "ei samaa eikä eri mieltä" ovat massoiltaan pienimmät.
(@) Pisteiden koko kuvaa rivin tai sarakkeen massaa.

```{r G1-3asymm1, eval=FALSE, include=FALSE}

# asymmetrinen kartta - rivit pc ja sarakkeet sc
#  (19.2.20) Käytetään "nuoliversiota"- tämä passiiviseksi
# HUOM! simpleCA1 luodaan G1_2_johdesim.Rmd - tiedostossa

plot(simpleCA1, map = "rowprincipal", 
     mass = c(TRUE,TRUE),
     main = "Lapsi kärsii jos äiti on töissä -asymmetrinen kartta" )

```

Tarinaa voi tarvittaessa jatkaa, tämä on CA:n hankalin asia. Kaksi koordinaatistoa, ja niiden yhteys.

(@) Asymmetrinen kuva ja akseleiden / dimensioiden tulkinta

Piirretään sama asymmetrinen kartta uudelleen, mutta yhdistetään sarakepisteet keskiarvopisteeseen (sentroidiin) suorilla. Mitä terävämpi on sarakesuoran (vektorin?) ja akselin kulma, sitä enemmän sarake määrittää tätä ulottuvuutta. Jos vektori on lähettä 45 asteen kulmaa, sarake määrittää yhtä paljon molempia ulottuvuuksia.
     
```{r G1-3asymm2,fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}

# asymmetrinen kartta - rivit pc ja sarakkeet sc
# sarakkeet vektorikuvina
# HUOM! simpleCA1 luodaan G1_2_johdesim.Rmd - tiedostossa
plot(simpleCA1, map = "rowprincipal", 
     arrows = c(FALSE,TRUE),
     main = "Lapsi kärsii jos äiti on töissä -asymmetrinen kartta 1" )

```

Sarakkeen "Eri mieltä" (e) määrittää toisen ulottuvuuden, jonka voisi tulkita 
erottelevan "maltilliset" mielipiteen tiukemmista. Sarake "täysin samaa mieltä" 
(S) määrittää toista ulottuvuutta lähes yhtä paljon kuin ensimmäistä, mutta "täysin 
eri mieltä" (E) on vasemmalla ja kolme vastausvaihtoehtoa oikealla. Kovin terävästi
dimensiot eivät eroa toisistaan?


```{r G1-3asymmContrib1,fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}
#X11() komentoriville ja plot-komento
plot(simpleCA1, map = "rowgreen",
     contrib = c("absolute", "absolute"),
     mass = c(TRUE,TRUE),
     arrows = c(FALSE, TRUE),
     main = "Lapsi kärsii jos äiti on töissä - asymmetrinen kartta 2a (rowgreen)",
     sub = "sarakevektorin ja rivipisteiden värin tummuus = kontribuutio(absolute)")

```



Greenacre (2006, "loose ends -artikkeli") ehdotti asymmetrisessä kuvassa standardikoordinaattien skaalaamista niin, että ne kerrotaan massan neliöjuurella. Tämä skaalaus toimii hyvin pienen ja suuren inertian tapauksessa. Kartoissa pätee sama sääntö kuin muussakin graafisessa data-analyyisissä, kuvien on esitettävä oleelliset yhteydet, mutta mielellään vain ne.

Sama kuva, kontribuutiot "relative". **edit 24.2.20** Ero selitettävä!

```{r G1-3asymmContrib2,fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}
#X11() komentoriville ja plot-komento
plot(simpleCA1, map = "rowgreen",
     contrib = c("relative", "relative"),
     mass = c(TRUE,TRUE),
     arrows = c(FALSE, TRUE),
     main = "Lapsi kärsii jos äiti on töissä - asymmetrinen kartta 2b (rowgreen)",
     sub = "sarakevektorin ja pisteen värin tummuus = kontribuutio(relative)")

```

**Tulkinta: rivipisteiden ortogonaalinen projektio "sarakevektorille"**

Asymmetrisessä kartassa 2 pisteiden koko on suhteessa niiden massaan, ja värisävy absoluuttiseen tai suhteelliseen kontribuutioon.


```{r G1_3_castats1}
# CA:n numeeriset tulokset
# (11.4.20) yhdistä koodilohkoon khii2dist1 (G1_2_johdesim.Rmd, r. 665)
# CA:n numeeristen tulosten käsittelyä myös CAcalc_1.R -skriptissä.

summary(simpleCA1)

# vertailun vuoksi numeeriset tulokset, kun maiden massat vakiot
summary(simpleCA3)

# Rivi- ja sarake-etäisyydet (keskiarvosta/sentroidista)
# HUOM! Edellisessä jaksossa taulukko rivi- ja sarake-etäisyyksistä. Tuskin
# kannattaa tässä toistaa. Muuta analyysiä numeerisista tuloksista. (10.4.20)

simpleCA1$rownames
simpleCA1$rowdist
simpleCA3$rowdist

simpleCA1$colnames
simpleCA1$coldist
simpleCA3$coldist

```
Ensimmäinen tuloste on CA maapainoilla, ja toisessa maapainot on vakioitu. 
CA-funktiolle on siinä annettu dataksi riviprofiilit, rivisummat ovat
ykkösiä. Edellisessä jaksossa esimerkki siistimmästä taulukosta.

**TODO** (21.2.20)

(@) Tätä voisi käyttää esimerkkinä numeeristen tulosten vertailussa?

(@) Kokonaisinertia kasvaa (0,18 -> 0,26), koordinaatisto muuttuu
mutta ei kovin radikaalisti.

(@) Kvaliteetti, kontribuutiot? Miten vertailla oleellisia asioita?

Belgian laatu putoavat merkittävästi,ja kontribuutiot pienenevät entisestään.

Saksan laatu paranee aika paljon, ja kontribuutiotkin jonkin verran.
Aika outoa,että suurimman massan maiden (DE,BE lähes puolet datasta)
kontribuutiot ovat niin pieniä (24.2.20)

(@) **Miksi sarakemassat muuttuvat?** Joku skaalaus, massojen "kaksoisrooli" painoina
ja normalisoivina ("varianssin tapaan") muunnoksina. Hieman on hämärä, edelleen! Teknisiä tuloksia
ei ehkä pidä käyttää mihinkään muuhun kuin kartan laadulliseen arviointiin ja
kuvan tulkintojen varmistamiseen?(24.2.20)

**zxy** Taulukon käsitteiden läpikäynti ja pureskelu kuulunee seuraavaan lukuun?

MG & Blasius, "vihreä kirja": kontribuutiot inertiaan